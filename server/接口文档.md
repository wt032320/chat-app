# w.w 后端接口文档



##  地址： http://127.0.0.1:8081



###  注册页

#### 1.用户注册

地址： /regist/add

**请求方式： POST**

参数：

| 字段 | 类型   | 说明   | 必须 |
| ---- | ------ | ------ | ---- |
| name | string | 用户名 | 是   |
| mail | string | 邮箱   | 是   |
| pwd  | string | 密码   | 是   |

返回值：

| 字段   | 类型 | 说明         | 必须 |
| ------ | ---- | ------------ | ---- |
| status | int  | 返回的状态码 | 是   |

#### 2.邮箱/用户是否存在验证

地址： /regist/judge

**请求方式：POST**

参数：

| 字段 | 类型   | 说明        | 必须 |
| ---- | ------ | ----------- | ---- |
| data | string | 邮箱/用户名 | 是   |
| type | string | name/email  | 是   |

返回值：

| 字段   | 类型 | 说明                   | 必须 |
| ------ | ---- | ---------------------- | ---- |
| status | int  | 返回的状态码           | 是   |
| result | int  | 0为不存在，大于0为存在 | 是   |

### 登录页

#### 1.用户登录

地址： /login/match

**请求方式：POST**

参数：

| 字段 | 类型   | 说明        | 必须 |
| ---- | ------ | ----------- | ---- |
| data | string | 用户名/邮箱 | 是   |
| pwd  | string | 密码        | 是   |

返回值：

| 字段   | 类型   | 说明         | 必须 |
| ------ | ------ | ------------ | ---- |
| status | int    | 返回的状态码 | 是   |
| name   | string | 用户名       | 是   |
| imgurl | string | 头像地址     | 是   |
| id     | string | 用户id       | 是   |
| token  | string | token        | 是   |

### 搜索页

#### 1.用户搜索

地址：/search/user

**请求方式：POST**

参数：

| 字段  | 类型   | 说明        | 必须 |
| ----- | ------ | ----------- | ---- |
| data  | string | 用户名/邮箱 | 是   |
| token | string | 验证        | 是   |

返回值：

| 字段   | 类型   | 说明     | 必须 |
| ------ | ------ | -------- | ---- |
| status | int    | 状态码   | 是   |
| name   | string | 用户名   | 是   |
| imgurl | string | 头像地址 | 是   |
| email  | string | 邮箱     | 是   |
| _id    | string | 用户id   | 是   |

#### 2.判断是否为好友

地址：/search/isfriend

**请求方式：POST**

参数：

| 字段  | 类型   | 说明       | 必须 |
| ----- | ------ | ---------- | ---- |
| uid   | string | 用户id     | 是   |
| fid   | string | 搜索对象id | 是   |
| token | string | 验证       | 是   |

返回值：

| 字段   | 类型 | 说明                 | 必须 |
| ------ | ---- | -------------------- | ---- |
| status | int  | 状态码200/400(是/否) | 是   |

#### 3.搜索群

地址：/search/group

**请求方式：POST**

参数：

| 字段  | 类型   | 说明   | 必须 |
| ----- | ------ | ------ | ---- |
| data  | string | 搜索词 | 是   |
| token | string | 验证   | 是   |

返回值：

| 字段   | 类型   | 说明       | 必须 |
| ------ | ------ | ---------- | ---- |
| status | int    | 状态码     | 是   |
| _id    | string | 群ID       | 是   |
| name   | string | 群名       | 是   |
| imgurl | string | 群头像地址 | 是   |

#### 2.判断是否在群里

地址：/search/ingroup

**请求方式：POST**

参数：

| 字段  | 类型   | 说明       | 必须 |
| ----- | ------ | ---------- | ---- |
| uid   | string | 用户id     | 是   |
| gid   | string | 搜索群的id | 是   |
| token | string | 验证       | 是   |

返回值：

| 字段   | 类型 | 说明                 | 必须 |
| ------ | ---- | -------------------- | ---- |
| status | int  | 状态码200/400(是/否) | 是   |

### 用户详情

#### 1.获取用户详情

地址：/user/detial

**请求方式：POST**

参数：

| 字段  | 类型   | 说明   | 必须 |
| ----- | ------ | ------ | ---- |
| id    | string | 用户id | 是   |
| token | string | 验证   | 是   |

 返回值:

| 字段    | 类型   | 说明     | 必须 |
| ------- | ------ | -------- | ---- |
| phone   | string | 电话     | 否   |
| name    | string | 用户名   | 是   |
| imgurl  | string | 头像地址 | 是   |
| email   | string | 邮箱     | 是   |
| _id     | string | 用户id   | 是   |
| birth   | date   | 生日     | 否   |
| sex     | string | 性别     | 是   |
| explain | string | 个性签名 | 否   |
| time    | date   | 注册时间 | 是   |

#### 2.用户信息修改

地址：/user/update

**请求方式：POST**

参数：

| 字段  | 类型   | 说明     | 必须 |
| ----- | ------ | -------- | ---- |
| id    | string | 用户id   | 是   |
| data  | string | 修改内容 | 是   |
| type  | string | 修改项   | 是   |
| pwd   | string | 原密码   | 否   |
| token | string | 验证     | 是   |

返回值：

| 字段   | 类型 | 说明                                           | 必须 |
| ------ | ---- | ---------------------------------------------- | ---- |
| status | int  | 状态码200/300/400/500(成功/占有/失败/发生错误) | 是   |

#### 3.修改好友备注

地址：/friend/markname

**请求方式：POST**

参数：

| 字段  | 类型   | 说明     | 必须 |
| ----- | ------ | -------- | ---- |
| uid   | string | 用户id   | 是   |
| fid   | string | 好友id   | 是   |
| token | string | 验证     | 是   |
| name  | string | 好友备注 | 是   |

返回值：

| 字段   | 类型 | 说明          | 必须 |
| ------ | ---- | ------------- | ---- |
| status | int  | 状态码200/500 | 是   |

#### 4.获取好友备注

地址：/friend/getname

**请求方式：POST**

参数：

| 字段  | 类型   | 说明   | 必须 |
| ----- | ------ | ------ | ---- |
| uid   | string | 用户id | 是   |
| fid   | string | 好友id | 是   |
| token | string | 验证   | 是   |

返回值：

| 字段   | 类型   | 说明          | 必须 |
| ------ | ------ | ------------- | ---- |
| status | int    | 状态码200/500 | 是   |
| result | object | 好友备注      | 是   |

### 好友操作

#### 1.好友申请

地址：/friend/apply

**请求方式：POST**

参数：

| 字段  | 类型   | 说明     | 必须 |
| ----- | ------ | -------- | ---- |
| uid   | string | 用户id   | 是   |
| fid   | string | 好友id   | 是   |
| token | string | 验证     | 是   |
| msg   | string | 申请留言 | 是   |

返回值：

| 字段   | 类型 | 说明          | 必须 |
| ------ | ---- | ------------- | ---- |
| status | int  | 状态码200/500 | 是   |

#### 2.同意好友

地址：/friend/newstate

**请求方式：POST**

参数：

| 字段  | 类型   | 说明   | 必须 |
| ----- | ------ | ------ | ---- |
| uid   | string | 用户id | 是   |
| fid   | string | 好友id | 是   |
| token | string | 验证   | 是   |

返回值：

| 字段   | 类型 | 说明          | 必须 |
| ------ | ---- | ------------- | ---- |
| status | int  | 状态码200/500 | 是   |



#### 3.拒绝好友/删除好友

地址：/friend/delete

**请求方式：POST**

参数：

| 字段  | 类型   | 说明   | 必须 |
| ----- | ------ | ------ | ---- |
| uid   | string | 用户id | 是   |
| fid   | string | 好友id | 是   |
| token | string | 验证   | 是   |

返回值：

| 字段   | 类型 | 说明          | 必须 |
| ------ | ---- | ------------- | ---- |
| status | int  | 状态码200/500 | 是   |

### 文件上传

地址：/files/upload

**请求方式：POST**

参数：

| 字段  | 类型   | 说明   | 必须 |
| ----- | ------ | ------ | ---- |
| url   | string | 路径   | 是   |
| name  | string | 文件名 | 是   |
| token | string | 验证   | 是   |

返回值：

| 字段 | 类型   | 说明   | 必须 |
| ---- | ------ | ------ | ---- |
| name | string | 文件名 | 是   |

### 首页

#### 1.获取好友列表

地址：/index/friends

**请求方式：POST**

参数：

| 字段  | 类型   | 说明     | 必须 |
| ----- | ------ | -------- | ---- |
| uid   | string | 用户id   | 是   |
| state | number | 关系类型 | 是   |
| token | string | 验证     | 是   |

返回值:

| 字段     | 类型   | 说明         | 必须 |
| -------- | ------ | ------------ | ---- |
| status   | int    | 状态码       | 是   |
| id       | string | 好友id       | 是   |
| name     | string | 好友昵称     | 是   |
| markname | string | 好友备注     | 是   |
| imgurl   | string | 好友头像链接 | 是   |
| lastTime | Date   | 最后通讯时间 | 是   |

#### 2.*获取最后一条消息*

地址：/index/endmessage

**请求方式：POST**

参数：

| 字段  | 类型   | 说明   | 必须 |
| ----- | ------ | ------ | ---- |
| uid   | string | 用户id | 是   |
| fid   | string | 好友id | 是   |
| token | string | 验证   | 是   |

返回值:

| 字段    | 类型   | 说明         | 必须 |
| ------- | ------ | ------------ | ---- |
| status  | int    | 状态码       | 是   |
| message | string | 消息内容     | 是   |
| time    | Date   | 消息发送时间 | 是   |
| types   | number | 消息类型     | 是   |

#### 3.*获取未读消息数*

地址：/index/msgnumber

**请求方式：POST**

参数：

| 字段  | 类型   | 说明   | 必须 |
| ----- | ------ | ------ | ---- |
| uid   | string | 用户id | 是   |
| fid   | string | 好友id | 是   |
| token | string | 验证   | 是   |

返回值:

| 字段   | 类型 | 说明            | 必须 |
| ------ | ---- | --------------- | ---- |
| status | int  | 状态码(200/500) | 是   |

#### 4.*好友消息标已读*

地址：/index/messaged

**请求方式：POST**

参数：

| 字段  | 类型   | 说明   | 必须 |
| ----- | ------ | ------ | ---- |
| uid   | string | 用户id | 是   |
| fid   | string | 好友id | 是   |
| token | string | 验证   | 是   |

返回值:

| 字段   | 类型 | 说明   | 必须 |
| ------ | ---- | ------ | ---- |
| status | int  | 状态码 | 是   |

#### 5.获取群列表

地址：/index/groups

**请求方式：POST**

参数：

| 字段  | 类型   | 说明                   | 必须 |
| ----- | ------ | ---------------------- | ---- |
| uid   | string | *uid 为用户，所在的群* | 是   |
| state | number | 关系类型               | 是   |
| token | string | 验证                   | 是   |

返回值:

| 字段     | 类型   | 说明         | 必须 |
| -------- | ------ | ------------ | ---- |
| status   | int    | 状态码       | 是   |
| gid      | string | 群id         | 是   |
| name     | string | 群名         | 是   |
| markname | string | 群内昵称     | 是   |
| imgurl   | string | 群头像       | 是   |
| lastTime | Date   | 最后通讯时间 | 是   |
| tip      | number | 未读消息数   | 是   |

#### 6.*获取最后一条群消息*

地址：/index/groupmsg

**请求方式：POST**

参数：

| 字段  | 类型   | 说明 | 必须 |
| ----- | ------ | ---- | ---- |
| gid   | string | 群id | 是   |
| token | string | 验证 | 是   |

返回值:

| 字段    | 类型   | 说明         | 必须 |
| ------- | ------ | ------------ | ---- |
| status  | int    | 状态码       | 是   |
| message | string | 消息内容     | 是   |
| time    | Date   | 消息发送时间 | 是   |
| types   | number | 消息类型     | 是   |
| name    | string | 发送者昵称   | 是   |

#### 7.*群消息标已读*

地址：/index/groupmsged

**请求方式：POST**

参数：

| 字段  | 类型   | 说明   | 必须 |
| ----- | ------ | ------ | ---- |
| uid   | string | 用户id | 是   |
| gid   | string | 群id   | 是   |
| token | string | 验证   | 是   |

返回值:

| 字段   | 类型 | 说明   | 必须 |
| ------ | ---- | ------ | ---- |
| status | int  | 状态码 | 是   |